{"version":3,"sources":["webpack://videojs-hlsjs-live-record/webpack/universalModuleDefinition","webpack://videojs-hlsjs-live-record/webpack/bootstrap","webpack://videojs-hlsjs-live-record/external \"videojs\"","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/createClass.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/defineProperty.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/get.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/inherits.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/typeof.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack://videojs-hlsjs-live-record/../node_modules/@babel/runtime/helpers/superPropBase.js","webpack://videojs-hlsjs-live-record/./components/ProgressControlHlsJs.js","webpack://videojs-hlsjs-live-record/./components/LiveButtonHlsJs.js","webpack://videojs-hlsjs-live-record/./components/CachedButtonHlsJs.js","webpack://videojs-hlsjs-live-record/./components/RecButtonHlsJs.js","webpack://videojs-hlsjs-live-record/./components/StopButtonHlsJs.js","webpack://videojs-hlsjs-live-record/./utils/format-time.js","webpack://videojs-hlsjs-live-record/./components/RecStatusBarHlsJs.js","webpack://videojs-hlsjs-live-record/./utils/uuid.js","webpack://videojs-hlsjs-live-record/./Components/recSettingsModal/RealTimeRecordTabHlsJs.js","webpack://videojs-hlsjs-live-record/./Components/recSettingsModal/BackgroundRecordTabHlsJs.js","webpack://videojs-hlsjs-live-record/./Components/recSettingsModal/TabsHlsJs.js","webpack://videojs-hlsjs-live-record/./Components/RecSettingsModalHlsJs.js","webpack://videojs-hlsjs-live-record/./Controllers/ViewController.js","webpack://videojs-hlsjs-live-record/./Controllers/StorageController.js","webpack://videojs-hlsjs-live-record/./Models/Fragment.js","webpack://videojs-hlsjs-live-record/./Models/Playlist.js","webpack://videojs-hlsjs-live-record/./utils/date.js","webpack://videojs-hlsjs-live-record/./utils/xhr-loader.js","webpack://videojs-hlsjs-live-record/./Controllers/RealtimeRecordController.js","webpack://videojs-hlsjs-live-record/./plugin.js"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","configurable","writable","protoProps","staticProps","obj","superPropBase","_get","receiver","Reflect","base","desc","getOwnPropertyDescriptor","_typeof","assertThisInitialized","subClass","superClass","constructor","ReferenceError","iterator","_setPrototypeOf","VideoJsProgressControlComponent","videojs","getComponent","ProgressControlHlsJs","dom","player","options","VideoJsButtonClass","defaultOptions","LiveButtonHlsJs","assign","tag","attributes","nonIconControl","className","innerHTML","el","controlText_","event","options_","clickHandler","arguments","CachedButtonHlsJs","RecButtonHlsJs","StopButtonHlsJs","defaultImplementation","seconds","guide","Math","floor","h","gm","gh","isNaN","Infinity","implementation","formatTime","VideoJsComponentClass","Dom","RecStatusBarHlsJs","elem","recordedEl_","createEl","innerText","appendChild","recordLeftEl_","updateRecordTime","updateRecordLeftTime","time","faceUUID","prefix","Date","now","RealTimeRecordTabHlsJs","hlsjs","hlsJSLiveRecord","getHlsJs","levels","currentLevel","map","item","index","label","height","selected","sort","current","next","realtimeRecord","allowed","renderHead","renderQualitySelector","renderButton","renderFooter","renderNotAllowedContent","content","modalHeaderContent","maxRecordMinutes","modalFooterContent","uuid","for","qualitySelect","id","getQualityLevels","forEach","text","holder","onclick","handleStartRecording","renderedEl_","notAllowedContent","startRealtimeRecord","BackgroundRecordTabHlsJs","console","group","log","groupEnd","TabsHlsJs","tabsHolder","renderNav","renderBody","navHolder","handleClick","bodyHolder","player_","elem1","el_","backgroundRecord","elem2","$$","elemIndex","addClass","removeClass","VideoJsModalDialogClass","RecSettingsModalHlsJs","tabsComponent","pauseOnOpen","fillAlways","temporary","uncloseable","registerComponent","ViewController","plugin","controlBar","getChild","space","addChild","removeDefaultControls","listOfControlsHiddenOnRec","selector","children","filter","component","hasClass","cachedButtonComponent","activeLiveMode","hide","liveButtonComponent","activateProgressMode","recButtonComponent","showRecordSettings","stopButtonComponent","stopRealtimeRecord","recStatusBarComponent","progressControlComponent","removeChild","showOtherControl","showLiveControl","hideProgressControl","hideRecControl","liveTracker","seekToLiveEdge","e","warn","message","state","recordInProcess","showProgressControl","hideLiveControl","recSettingsModalComponent","open","close","hideOtherControl","showRecControl","maxRecordSeconds","a","recordUpdateInterval","setInterval","show","clearInterval","StorageController","db","openRequest","indexedDB","storageDbName","onupgradeneeded","result","objectStoreNames","contains","storagePlaylistsName","createObjectStore","keyPath","storageFragmentsName","createIndex","unique","onsuccess","window","fragment","payload","stats","Promise","resolve","request","transaction","objectStore","add","onerror","playlist","put","FragmentModel","fragmentData","duration","url","playlistId","split","pop","saved","PlaylistModel","playlistData","width","fragments","targetduration","mime","createdAt","updatedAt","recFinished","push","frag","duraction","join","normalize","number","toFormatYmdHis","date","separator","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","nowInFormatYmdHis","performance","XMLHttpRequest","XhrLoader","config","xhrSetup","abort","loader","readyState","aborted","clearTimeout","requestTimeout","retryTimeout","context","callbacks","trequest","retry","retryDelay","loadInternal","xhr","tfirst","loaded","onError","code","status","rangeEnd","setRequestHeader","rangeStart","onreadystatechange","readystatechange","onprogress","loadprogress","responseType","setTimeout","loadtimeout","timeout","send","currentTarget","max","data","len","tload","response","byteLength","responseText","total","responseURL","onSuccess","maxRetry","statusText","destroy","min","maxRetryDelay","onTimeout","lengthComputable","onProgress","Hls","faceMimePromise","RealtimeRecordController","storageController","saveFragment","then","fragmentSaved","savePlaylist","recordStarted","manifestListener","levelListener","fragmentListener","on","Events","FRAG_LOADED","hlsFragmentLoaded","finished","initPlaylist","level","loaderContext","addFragment","progressData","loaderCallbacks","fragmentLoaded","load","levelIndex","mimePromise","getRecordMime","details","Plugin","getPlugin","defaults","HlsJSLiveRecordPlugin","init","setState","checkRequirements","viewController","realtimeRecordController","tech","IWillUseThisInPlugin","sourceHandler_","hls","stopRecord","mergeOptions","levelId","activateRecordMode","startRecord","VERSION","defaultState","recordAllowed","registerPlugin"],"mappings":"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","file":"videojs-hlsjs-live-record.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"videojs\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"videojs-hlsjs-live-record\", [\"videojs\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"videojs-hlsjs-live-record\"] = factory(require(\"videojs\"));\n\telse\n\t\troot[\"videojs-hlsjs-live-record\"] = factory(root[\"videojs\"]);\n})((typeof self !== 'undefined' ? self : this), function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","import videojs from 'video.js';\n\nconst VideoJsProgressControlComponent = videojs.getComponent('ProgressControl');\nconst Dom = videojs.dom;\n\n\n/**\n * Extend vjs button class for quality button.\n */\nexport default class ProgressControlHlsJs extends VideoJsProgressControlComponent {\n  constructor(player, options) {\n    super(player, options);\n  }\n}\n","import videojs from 'video.js';\n\nconst VideoJsButtonClass = videojs.getComponent('Button');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nexport default class LiveButtonHlsJs extends VideoJsButtonClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, Object.assign(defaultOptions, options));\n  }\n\n  createEl(tag, props = {}, attributes = {}) {\n    this.nonIconControl = true;\n\n    props = Object.assign({\n      className: 'vjs-control vjs-seek-to-live-control vjs-at-live-edge',\n      innerHTML: '<span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>LIVE',\n    }, props);\n\n    attributes = Object.assign({\n      'aria-live': 'off'\n    }, attributes);\n\n    return super.createEl(tag, props, attributes);\n  }\n\n  createControlTextEl(el) {\n    this.controlText_ = 'Stream Type';\n    super.createControlTextEl(el);\n  }\n\n  handleClick(event) {\n    if (this.options_.clickHandler) {\n      this.options_.clickHandler.call(this, arguments);\n    }\n  }\n}\n","import videojs from 'video.js';\n\nconst VideoJsButtonClass = videojs.getComponent('Button');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nexport default class CachedButtonHlsJs extends VideoJsButtonClass {\n  \n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, Object.assign(defaultOptions, options));\n  }\n\n  createEl(tag, props = {}, attributes = {}) {\n    this.nonIconControl = true;\n\n    props = Object.assign({\n      // className: 'vjs-live-display',\n      // innerHTML: 'DVR',\n      className: 'vjs-seek-to-live-control',\n      innerHTML: '<span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>LIVE',\n    }, props);\n\n    attributes = Object.assign({\n      'aria-live': 'On'\n    }, attributes);\n\n    return super.createEl(tag, props, attributes);\n  }\n\n  createControlTextEl(el) {\n    this.controlText_ = 'Stream Type';\n    super.createControlTextEl(el);\n  }\n\n  handleClick(event) {\n    if (this.options_.clickHandler) {\n      this.options_.clickHandler.call(this, arguments);\n    }\n  }\n}\n","import videojs from 'video.js';\n\nconst VideoJsButtonClass = videojs.getComponent('Button');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nexport default class RecButtonHlsJs extends VideoJsButtonClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, Object.assign(defaultOptions, options));\n  }\n\n  createEl(tag, props = {}, attributes = {}) {\n    this.nonIconControl = true;\n\n    props = Object.assign({\n      className: 'vjs-control vjs-seek-to-live-control',\n      innerHTML: '<span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>REC',\n    }, props);\n\n    attributes = Object.assign({\n      'aria-live': 'On'\n    }, attributes);\n\n    return super.createEl(tag, props, attributes);\n  }\n\n  createControlTextEl(el) {\n    this.controlText_ = 'Start Record';\n    super.createControlTextEl(el);\n  }\n\n  handleClick(event) {\n    if (this.options_.clickHandler) {\n      this.options_.clickHandler.call(this, arguments);\n    }\n  }\n}\n","import videojs from 'video.js';\n\nconst VideoJsButtonClass = videojs.getComponent('Button');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nexport default class StopButtonHlsJs extends VideoJsButtonClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, Object.assign(defaultOptions, options));\n  }\n\n  createEl(tag, props = {}, attributes = {}) {\n    this.nonIconControl = false;\n\n    props = Object.assign({\n      className: 'vjs-control vjs-hlsjs-lr-stop',\n      innerHTML: '<i class=\"material-icons\">stop</i>',\n    }, props);\n\n    return super.createEl(tag, props, attributes);\n  }\n\n  createControlTextEl(el) {\n    this.controlText_ = 'Stop Record';\n    super.createControlTextEl(el);\n  }\n\n  handleClick(event) {\n    if (this.options_.clickHandler) {\n      this.options_.clickHandler.call(this, arguments);\n    }\n  }\n}\n","/**\n * @file format-time.js\n * @module format-time\n */\n\n/**\n * Format seconds as a time string, H:MM:SS or M:SS. Supplying a guide (in\n * seconds) will force a number of leading zeros to cover the length of the\n * guide.\n *\n * @private\n * @param  {number} seconds\n *         Number of seconds to be turned into a string\n *\n * @param  {number} guide\n *         Number (in seconds) to model the string after\n *\n * @return {string}\n *         Time formatted as H:MM:SS or M:SS\n */\nconst defaultImplementation = function(seconds, guide) {\n  seconds = seconds < 0 ? 0 : seconds;\n  let s = Math.floor(seconds % 60);\n  let m = Math.floor(seconds / 60 % 60);\n  let h = Math.floor(seconds / 3600);\n  const gm = Math.floor(guide / 60 % 60);\n  const gh = Math.floor(guide / 3600);\n\n  // handle invalid times\n  if (isNaN(seconds) || seconds === Infinity) {\n    // '-' is false for all relational operators (e.g. <, >=) so this setting\n    // will add the minimum number of fields specified by the guide\n    h = m = s = '-';\n  }\n\n  // Check if we need to show hours\n  h = (h > 0 || gh > 0) ? h + ':' : '';\n\n  // If hours are showing, we may need to add a leading zero.\n  // Always show at least one digit of minutes.\n  m = (((h || gm >= 10) && m < 10) ? '0' + m : m) + ':';\n\n  // Check if leading zero is need for seconds\n  s = (s < 10) ? '0' + s : s;\n\n  return h + m + s;\n};\n\n// Internal pointer to the current implementation.\nlet implementation = defaultImplementation;\n\n/**\n * Replaces the default formatTime implementation with a custom implementation.\n *\n * @param {Function} customImplementation\n *        A function which will be used in place of the default formatTime\n *        implementation. Will receive the current time in seconds and the\n *        guide (in seconds) as arguments.\n */\nexport function setFormatTime(customImplementation) {\n  implementation = customImplementation;\n}\n\n/**\n * Resets formatTime to the default implementation.\n */\nexport function resetFormatTime() {\n  implementation = defaultImplementation;\n}\n\n/**\n * Delegates to either the default time formatting function or a custom\n * function supplied via `setFormatTime`.\n *\n * Formats seconds as a time string (H:MM:SS or M:SS). Supplying a\n * guide (in seconds) will force a number of leading zeros to cover the\n * length of the guide.\n *\n * @static\n * @example  formatTime(125, 600) === \"02:05\"\n * @param    {number} seconds\n *           Number of seconds to be turned into a string\n *\n * @param    {number} guide\n *           Number (in seconds) to model the string after\n *\n * @return   {string}\n *           Time formatted as H:MM:SS or M:SS\n */\nfunction formatTime(seconds, guide = seconds) {\n  return implementation(seconds, guide);\n}\n\nexport default formatTime;\n","import videojs from 'video.js';\nimport formatTime from '../utils/format-time';\n\nconst VideoJsComponentClass = videojs.getComponent('Component');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nexport default class RecStatusBarHlsJs extends VideoJsComponentClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, Object.assign(defaultOptions, options));\n  }\n\n  createEl() {\n    this.nonIconControl = true;\n    const elem = super.createEl('div', {\n      className: 'vjs-control vjs-hlsjs-lr-rec-status-bar',\n      innerHTML: '<span class=\"vjs-hlsjs-lr-rec-indicator\"><i class=\"material-icons md-10\">fiber_manual_record</i>REC</span>'\n    });\n\n\n    this.recordedEl_ = Dom.createEl('span', {\n      className: 'vjs-hlsjs-lr-recorded',\n      innerText: '--:--:--'\n    }, {\n      'aria-live': 'off',\n      'role': 'presentation'\n    });\n    elem.appendChild(this.recordedEl_);\n\n    elem.appendChild(\n      Dom.createEl('span', {\n        className: 'vjs-hlsjs-lr-divider',\n        innerText: '/'\n      }, {\n        'aria-live': 'off',\n        'role': 'presentation'\n      })\n    );\n\n    this.recordLeftEl_ = Dom.createEl('span', {\n      className: 'vjs-hlsjs-lr-record-left',\n      innerText: '--:--:--'\n    }, {\n      'aria-live': 'off',\n      'role': 'presentation'\n    });\n    elem.appendChild(this.recordLeftEl_);\n\n    this.updateRecordTime(0);\n    this.updateRecordLeftTime(60 * 60);\n    return elem;\n  };\n\n  updateRecordTime(time) {\n    if(this.recordedEl_) {\n      this.recordedEl_.innerText = formatTime(time);\n    }\n  };\n\n  updateRecordLeftTime(time) {\n    if(this.recordLeftEl_) {\n      this.recordLeftEl_.innerText = formatTime(time);\n    }\n  };\n\n  dispose() {\n    this.recordedEl_ = null;\n    this.recordLeftEl_ = null;\n\n    super.dispose();\n  }\n\n}\n","export const faceUUID = (prefix) => {\n  return prefix + '-' + Date.now()\n};\n","import videojs from 'video.js';\nimport {faceUUID} from \"../../utils/uuid\";\n\nconst VideoJsComponentClass = videojs.getComponent('Component');\nconst Dom = videojs.dom;\n/**\n * Extend vjs button class for quality button.\n */\nclass RealTimeRecordTabHlsJs extends VideoJsComponentClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, options);\n  }\n\n  getQualityLevels() {\n    const hlsjs = this.player().hlsJSLiveRecord().getHlsJs();\n    const levels = hlsjs.levels || [];\n    const currentLevel = hlsjs.currentLevel || 0;\n    return levels.map((item, index) => (\n      {\n        label: item.height + 'p',\n        value: index,\n        selected: index === currentLevel,\n      }\n    )).sort((current, next) => {\n      if ((typeof current !== 'object') || (typeof next !== 'object')) {\n        return -1;\n      }\n      if (current.value < next.value) {\n        return -1;\n      }\n      if (current.value > next.value) {\n        return 1;\n      }\n      return 0;\n    });\n  }\n\n  createEl() {\n    const elem = super.createEl(\n      'div',\n      {\n        className: 'vjs-hlsjs-tab-realtime-record',\n      },\n    );\n\n    if(this.options().realtimeRecord.allowed) {\n      elem.appendChild(this.renderHead());\n      elem.appendChild(this.renderQualitySelector());\n      elem.appendChild(this.renderButton());\n      elem.appendChild(this.renderFooter());\n    } else {\n      return elem.appendChild(this.renderNotAllowedContent());\n    }\n\n    return elem;\n  }\n\n  renderHead() {\n    const content = (this.options().realtimeRecord.modalHeaderContent || (() => (\n      \"<p>Real-time recording allows you to record a fragment of the program you are watching. \" +\n      \"Recording will be done until the recording stops, the recording time limit is exceeded or the tab is closed.\" +\n      \"To start recording, select your preferred quality and click <strong>\\\"start recording\\\"</strong>.</p>\" +\n      \"<p>Your current recording time limit is \" + this.options().maxRecordMinutes + \" min.</p>\"\n    )))() ;\n    return Dom.createEl('div', {\n      innerHTML: content\n    })\n  }\n\n  renderFooter() {\n    const content = (this.options().realtimeRecord.modalFooterContent || (() => ('')))() ;\n    return Dom.createEl('div', {\n      innerHTML: content\n    })\n  }\n\n  renderQualitySelector() {\n    const elem = Dom.createEl(\n      'div',\n      {\n        className: 'vjs-hlsjs-tab-quality-select vjs-hlsjs-form-group',\n      },\n    );\n    const uuid = faceUUID('vjs-hls-quality-select');\n\n    elem.appendChild(\n      Dom.createEl('label', {\n        for: uuid,\n        innerText: 'Quality',\n        className: 'vjs-hlsjs-form-label'\n      })\n    );\n\n    this.qualitySelect = Dom.createEl('select', {\n      id: uuid,\n      className: 'vjs-hlsjs-form-input'\n    });\n\n    const levels = this.getQualityLevels();\n\n    levels.forEach((item) => {\n      this.qualitySelect.appendChild(\n        Dom.createEl('option', {\n          value: item.value,\n          text: item.label,\n          selected: item.selected\n        })\n      );\n      if(item.selected) {\n        this.qualitySelect.value = item.value;\n      }\n    });\n\n    elem.appendChild(this.qualitySelect);\n\n    return elem;\n  }\n\n  renderButton() {\n    const holder = Dom.createEl(\n      'div',\n      {\n        className: 'vjs-hlsjs-form-group',\n      }\n    );\n\n    holder.appendChild(Dom.createEl('button', {\n      className: 'vjs-hlsjs-button vjs-hlsjs-start-record',\n      innerText: 'Start Recording',\n      onclick: this.handleStartRecording.bind(this)\n    }));\n\n    return holder;\n  }\n\n  renderNotAllowedContent() {\n    if(this.renderedEl_) {\n      return this.renderedEl_;\n    }\n\n    const content = (this.options().realtimeRecord.notAllowedContent || (() => ('<h2>Recording not allowed</h2>')))();\n\n    this.renderedEl_ = Dom.createEl('div', {\n      className: '',\n      innerHTML: content,\n    });\n\n    return this.renderedEl_;\n  }\n\n  handleStartRecording() {\n    this.player().hlsJSLiveRecord().startRealtimeRecord(this.qualitySelect.value);\n  }\n}\n\nexport default RealTimeRecordTabHlsJs;\n","import videojs from 'video.js';\n\nconst VideoJsComponentClass = videojs.getComponent('Component');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nclass BackgroundRecordTabHlsJs extends VideoJsComponentClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    console.group(\"BackgroundRecordTabHlsJs.js:20 - constructor\");\n    console.log(player);\n    console.groupEnd();\n    super(player, options);\n  }\n\n  createEl() {\n    return super.createEl(\n      'div',\n      {\n        className: 'vjs-hlsjs-tab-background-record',\n        innerHTML: '<p>vjs-hlsjs-tab-background-record</p>'\n      },\n    );\n  }\n}\n\nexport default BackgroundRecordTabHlsJs;\n","import videojs from 'video.js';\nimport RealTimeRecordTabHlsJs from \"./RealTimeRecordTabHlsJs\";\nimport BackgroundRecordTabHlsJs from \"./BackgroundRecordTabHlsJs\";\n\nconst VideoJsComponentClass = videojs.getComponent('Component');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nclass TabsHlsJs extends VideoJsComponentClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, options);\n  }\n\n  createEl() {\n    const tabsHolder = super.createEl(\n      'div',\n      {\n        className: 'vjs-hlsjs-vertical-tabs',\n      },\n    );\n\n    tabsHolder.appendChild(this.renderNav());\n\n    tabsHolder.appendChild(this.renderBody());\n\n    return tabsHolder;\n  }\n\n\n  renderNav() {\n    const navHolder = Dom.createEl('div', {\n      className: 'vjs-hlsjs-vertical-tabs-nav'\n    });\n    navHolder.appendChild(\n      Dom.createEl('div', {\n        className: 'vjs-hlsjs-vertical-tabs-nav-elem active',\n        innerHTML: 'Realtime',\n        onclick: () => {this.handleClick(0)}\n      })\n    );\n\n    navHolder.appendChild(\n      Dom.createEl('div', {\n        className: 'vjs-hlsjs-vertical-tabs-nav-elem',\n        innerHTML: 'Background',\n        onclick: () => {this.handleClick(1)}\n      })\n    );\n\n    return navHolder;\n  }\n\n  renderBody() {\n    const bodyHolder = Dom.createEl('div', {\n      className: 'vjs-hlsjs-vertical-tabs-body'\n    });\n\n    this.realtimeRecord = new RealTimeRecordTabHlsJs(this.player_, this.options());\n    const elem1 = Dom.createEl('div', {\n      className: 'vjs-hlsjs-vertical-tabs-elem active'\n    });\n    elem1.appendChild(this.realtimeRecord.el_);\n    bodyHolder.appendChild(elem1);\n\n    this.backgroundRecord = new BackgroundRecordTabHlsJs(this.player_, this.options());\n    const elem2 = Dom.createEl('div', {\n      className: 'vjs-hlsjs-vertical-tabs-elem'\n    });\n    elem2.appendChild(this.backgroundRecord.el_);\n    bodyHolder.appendChild(elem2);\n\n    return bodyHolder;\n  }\n\n  handleClick(index) {\n    this.$$('.vjs-hlsjs-vertical-tabs-nav-elem').forEach((elem, elemIndex) => {\n      if(index === elemIndex) {\n        Dom.addClass(elem, 'active');\n      } else {\n        Dom.removeClass(elem, 'active');\n      }\n    });\n    this.$$('.vjs-hlsjs-vertical-tabs-elem').forEach((elem, elemIndex) => {\n      if(index === elemIndex) {\n        Dom.addClass(elem, 'active');\n      } else {\n        Dom.removeClass(elem, 'active');\n      }\n    });\n  };\n}\n\nexport default TabsHlsJs;\n","import videojs from 'video.js';\nimport TabsHlsJs from \"./recSettingsModal/TabsHlsJs\";\n\nconst VideoJsModalDialogClass = videojs.getComponent('ModalDialog');\nconst Dom = videojs.dom;\n\nconst defaultOptions = {};\n\n/**\n * Extend vjs button class for quality button.\n */\nclass RecSettingsModalHlsJs extends VideoJsModalDialogClass {\n\n  /**\n   * Button constructor.\n   *\n   * @param {Player} player - videojs player instance\n   * @param {Object} options\n   */\n  constructor(player, options) {\n    super(player, options);\n  }\n\n  /**\n   * Builds the default DOM `className`.\n   *\n   * @return {string}\n   *         The DOM `className` for this object.\n   *\n   * @deprecated Since version 5.\n   */\n  buildCSSClass() {\n    return `vjs-hlsjs-lr-rec-settings ${super.buildCSSClass()}`;\n  }\n\n  /**\n   * Gets the localized error message based on the `Player`s error.\n   *\n   * @return {string}\n   *         The `Player`s error message localized or an empty string.\n   */\n  content() {\n    if(this.options().allowed) {\n      this.tabsComponent = new TabsHlsJs(this.player_, this.options());\n      return this.tabsComponent.el_;\n    } else {\n      return this.renderNotAllowedContent();\n    }\n  }\n\n  renderNotAllowedContent() {\n    if(this.renderedEl_) {\n      return this.renderedEl_;\n    }\n\n    const content = (this.options().notAllowedContent || (() => ('<h2>Recording not allowed</h2>')))();\n\n    this.renderedEl_ = Dom.createEl('div', {\n      className: '',\n      innerHTML: content,\n    });\n\n    return this.renderedEl_;\n  }\n}\n\nRecSettingsModalHlsJs.prototype.options_ = Object.assign({}, VideoJsModalDialogClass.prototype.options_, {\n  pauseOnOpen: false,\n  fillAlways: false,\n  temporary: true,\n  uncloseable: false\n});\n\nvideojs.registerComponent('RecSettingsModalHlsJs', RecSettingsModalHlsJs);\nexport default RecSettingsModalHlsJs;\n","import RecSettingsModalHlsJs from \"../Components/RecSettingsModalHlsJs\";\n\nclass ViewController {\n  constructor(plugin) {\n    this.plugin = plugin;\n\n    this.recButtonComponent = null;\n    this.stopButtonComponent = null;\n    this.recStatusBarComponent = null;\n    this.progressControlComponent = null;\n    this.liveButtonComponent = null;\n    this.cachedButtonComponent = null;\n\n\n    this.recSettingsModalComponent = null;\n\n    this.listOfControlsHiddenOnRec = [];\n  }\n\n  init = () => {\n    const controlBar = this.plugin.player.getChild('ControlBar');\n    const space = controlBar.addChild('Component', {}, 2);\n    space.addClass('vjs-hlsjs-controls-holder');\n\n    this.removeDefaultControls();\n\n    this.listOfControlsHiddenOnRec = this.plugin.options.listOfControlsHiddenOnRec.map((selector) => {\n      return controlBar.children().filter(component => component.hasClass(selector))[0];\n    }).filter(component => !!component);\n\n    this.cachedButtonComponent = space.addChild('CachedButtonHlsJs', {\n      clickHandler: this.activeLiveMode\n    }, 1);\n    this.cachedButtonComponent.hide();\n\n    this.liveButtonComponent = controlBar.addChild('LiveButtonHlsJs', {\n      clickHandler: this.activateProgressMode\n    }, 2);\n    this.liveButtonComponent.hide();\n\n    this.recButtonComponent = space.addChild('RecButtonHlsJs', {\n      clickHandler: this.showRecordSettings\n    }, 1);\n    this.recButtonComponent.hide();\n\n    this.stopButtonComponent = controlBar.addChild('StopButtonHlsJs', {\n      clickHandler: this.plugin.stopRealtimeRecord\n    }, 1);\n    this.stopButtonComponent.hide();\n\n    this.recStatusBarComponent = space.addChild('RecStatusBarHlsJs', 1);\n    this.recStatusBarComponent.hide();\n\n    this.progressControlComponent = space.addChild('ProgressControlHlsJs', {}, 2);\n    this.progressControlComponent.hide();\n\n    this.activeLiveMode();\n  };\n\n  removeDefaultControls = () => {\n    const controlBar = this.plugin.player.getChild('ControlBar');\n    controlBar.removeChild('ProgressControl');\n    controlBar.removeChild('SeekToLive');\n    controlBar.removeChild('LiveDisplay');\n  };\n\n  activeLiveMode = () => {\n    try {\n      this.showOtherControl();\n      this.showLiveControl();\n      this.hideProgressControl();\n      this.hideRecControl();\n      this.plugin.player.liveTracker.seekToLiveEdge();\n    } catch (e) {\n      this.plugin.player.log.warn(e.message)\n    }\n  };\n\n  activateProgressMode = () => {\n    if(this.plugin.state.recordInProcess) {\n      return;\n    }\n    this.showOtherControl();\n    this.showProgressControl();\n    this.hideLiveControl();\n    this.hideRecControl();\n  };\n\n  showRecordSettings = () => {\n    this.recSettingsModalComponent = new RecSettingsModalHlsJs(this.plugin.player, this.plugin.options);\n    this.plugin.player.addChild(this.recSettingsModalComponent);\n    this.recSettingsModalComponent.open();\n  };\n\n  activateRecordMode = () => {\n    this.recSettingsModalComponent.close();\n    this.hideProgressControl();\n    this.hideLiveControl();\n    this.hideOtherControl();\n    this.showRecControl();\n  };\n\n  showRecControl = () => {\n    const maxRecordSeconds = this.plugin.options.maxRecordMinutes * 60;\n    this.plugin.player.addClass('vjs-hlsjs-record-started');\n    this.recStatusBarComponent.updateRecordLeftTime(maxRecordSeconds);\n    this.recStatusBarComponent.updateRecordTime(0);\n    let a = 1;\n    this.recordUpdateInterval = setInterval(() => {\n      if(a >= maxRecordSeconds) {\n        this.plugin.stopRealtimeRecord();\n      }\n      this.recStatusBarComponent.updateRecordTime(a++);\n    }, 1000);\n\n    this.stopButtonComponent.show();\n    this.recStatusBarComponent.show();\n  };\n\n  hideRecControl = () => {\n    this.plugin.player.removeClass('vjs-hlsjs-record-started');\n    clearInterval(this.recordUpdateInterval);\n    this.stopButtonComponent.hide();\n    this.recStatusBarComponent.hide();\n  };\n\n  showProgressControl = () => {\n    this.progressControlComponent.show();\n    this.cachedButtonComponent.show();\n  };\n\n  hideProgressControl = () => {\n    this.progressControlComponent.hide();\n    this.cachedButtonComponent.hide();\n  };\n\n  hideOtherControl = () => {\n    this.listOfControlsHiddenOnRec.forEach(component => component.addClass('vjs-hlsjs-lr-hidden'));\n  };\n\n  showOtherControl = () => {\n    this.listOfControlsHiddenOnRec.forEach(component => component.removeClass('vjs-hlsjs-lr-hidden'));\n  };\n\n\n  showLiveControl = () => {\n    this.liveButtonComponent.show();\n    this.recButtonComponent.show();\n  };\n\n  hideLiveControl = () => {\n    this.liveButtonComponent.hide();\n    this.recButtonComponent.hide();\n  };\n\n}\n\nexport default ViewController;\n","const DB_VERSION = 1;\nconst STORAGE_WRITE_MODE = 'readwrite';\nconst STORAGE_READ_MODE = 'readonly';\n\nclass StorageController {\n  constructor(plugin) {\n    this.plugin = plugin;\n    this.db = null;\n  }\n\n\n  init() {\n    const openRequest = indexedDB.open(this.plugin.options.storageDbName, DB_VERSION);\n    openRequest.onupgradeneeded = () => {\n      this.db = openRequest.result;\n      if (!this.db.objectStoreNames.contains(this.options.storagePlaylistsName)) {\n        this.db.createObjectStore(this.options.storagePlaylistsName, {keyPath: 'id'});\n      }\n      if (!this.db.objectStoreNames.contains(this.options.storageFragmentsName)) {\n        const fragmentsStorage = this.db.createObjectStore(this.options.storageFragmentsName, {keyPath: 'uuid'});\n        fragmentsStorage.createIndex('playlistId', 'playlistId', {unique: false});\n      }\n    };\n\n    openRequest.onsuccess = () => {\n      this.db = openRequest.result;\n    };\n  }\n\n  checkRequirements() {\n    return 'indexedDB' in window;\n  }\n\n  //TODO: need to add error processing\n  saveFragment(fragment, payload, stats) {\n    return new Promise((resolve) => {\n      if(this.db === null) {\n        resolve(true);\n        return;\n      }\n      const transaction = this.db.transaction(this.plugin.options.storageFragmentsName, STORAGE_WRITE_MODE);\n      const storage = transaction.objectStore(this.plugin.options.storageFragmentsName);\n      const request = storage.add({\n        ...fragment,\n        payload,\n        stats\n      });\n\n      request.onsuccess = function() {\n        // console.group(\"cache-driver.js:17 - store - onsuccess\");\n        // console.log(request);\n        // console.groupEnd();\n      };\n      request.onerror = function() {\n        // console.group(\"cache-driver.js:17 - store - onerror\");\n        // console.warn(request);\n        // console.groupEnd();\n      };\n      resolve(true);\n    });\n  }\n\n  //TODO: need to add error processing\n  savePlaylist(playlist) {\n    return new Promise((resolve) => {\n      if(this.db === null) {\n        resolve(true);\n        return;\n      }\n      const transaction = this.db.transaction(this.plugin.options.storagePlaylistsName, STORAGE_WRITE_MODE);\n      const storage = transaction.objectStore(this.plugin.options.storagePlaylistsName);\n      const request = storage.put(playlist);\n\n      request.onsuccess = function() {\n        // console.group(\"cache-driver.js:17 - store - onsuccess\");\n        // console.log(request);\n        // console.groupEnd();\n      };\n      request.onerror = function() {\n        // console.group(\"cache-driver.js:17 - store - onerror\");\n        // console.warn(request);\n        // console.groupEnd();\n      };\n      resolve(true);\n    });\n  }\n\n\n}\n\nexport default StorageController;\n","import {faceUUID} from \"../utils/uuid\";\n\nexport class FragmentModel {\n  constructor(fragmentData) {\n    this.duration = fragmentData.duration || 0;\n    this.url = fragmentData.url || '';\n    this.playlistId = fragmentData.playlistId || 'tmp';\n    this.uuid = faceUUID(this.playlistId + '-' + this.url.split('/').pop());\n    this.saved = fragmentData.saved || false;\n  }\n}\n","import {FragmentModel} from \"./Fragment\";\n\nconst createPlaylistHeader = (targetduration) => {\n  return \"#EXTM3U\\n\" +\n    \"#EXT-X-VERSION:4\\n\" +\n    \"#EXT-X-TARGETDURATION:\" + targetduration + \"\\n\" +\n    \"#EXT-X-MEDIA-SEQUENCE:0\\n\";\n};\nconst addPlaylistFragment = (duraction, url) => {\nreturn \"#EXTINF:\" + duraction + \",\\n\" +\n  url + \"\\n\";\n};\nconst createPlaylistFooter = () => {\n  return \"#EXT-X-ENDLIST\\n\";\n};\n\n\nexport class PlaylistModel {\n  constructor(playlistData) {\n    this.id = playlistData.id || '';\n    this.width = playlistData.width || 384;\n    this.height = playlistData.height || 384;\n    this.fragments = playlistData.fragments || [];\n    this.targetduration = playlistData.targetduration || 0;\n    this.mime = playlistData.mime || {};\n    this.createdAt = playlistData.createdAt || Date.now();\n    this.updatedAt = playlistData.updatedAt || null;\n    this.recFinished = playlistData.recFinished || false;\n  }\n\n  addFragment(duration, url) {\n    const fragment = new FragmentModel({duration, url});\n    this.fragments.push(fragment);\n    return fragment;\n  }\n\n  fragmentSaved(fragment) {\n    this.fragments = this.fragments.map((frag) => {\n      if(frag.uuid === fragment.uuid) {\n        frag.saved = true;\n      }\n      return frag;\n    });\n\n    this.updatedAt = Date.now();\n  }\n\n  finished() {\n    this.updatedAt = Date.now();\n    this.recFinished = true;\n  }\n\n  toString() {\n    return createPlaylistHeader(this.targetduration) +\n      (this.fragments.filter(fragment => (fragment.saved))\n        .map(fragment => (addPlaylistFragment(fragment.duration, fragment.uuid))).join('')) +\n      createPlaylistFooter();\n  }\n}\n","const normalize = (number) => (number < 10 ? '0' + number : number);\n\nexport const toFormatYmdHis = (date, separator) => {\n  return [\n    date.getFullYear(),\n    normalize(date.getMonth() + 1),\n    normalize(date.getDate()),\n    normalize(date.getHours()),\n    normalize(date.getMinutes()),\n    normalize(date.getSeconds()),\n  ].join(separator);\n};\n\nexport const nowInFormatYmdHis = (separator = '-') => {\n  return toFormatYmdHis(new Date(), separator);\n};\n","const { performance, XMLHttpRequest } = window;\n\nclass XhrLoader {\n  constructor (config) {\n    if (config && config.xhrSetup) {\n      this.xhrSetup = config.xhrSetup;\n    }\n  }\n\n  destroy () {\n    this.abort();\n    this.loader = null;\n  }\n\n  abort () {\n    let loader = this.loader;\n    if (loader && loader.readyState !== 4) {\n      this.stats.aborted = true;\n      loader.abort();\n    }\n\n    window.clearTimeout(this.requestTimeout);\n    this.requestTimeout = null;\n    window.clearTimeout(this.retryTimeout);\n    this.retryTimeout = null;\n  }\n\n  load (context, config, callbacks) {\n    this.context = context;\n    this.config = config;\n    this.callbacks = callbacks;\n    this.stats = { trequest: performance.now(), retry: 0 };\n    this.retryDelay = config.retryDelay;\n    this.loadInternal();\n  }\n\n  loadInternal () {\n    let xhr, context = this.context;\n    xhr = this.loader = new XMLHttpRequest();\n\n    let stats = this.stats;\n    stats.tfirst = 0;\n    stats.loaded = 0;\n    const xhrSetup = this.xhrSetup;\n\n    try {\n      if (xhrSetup) {\n        try {\n          xhrSetup(xhr, context.url);\n        } catch (e) {\n          // fix xhrSetup: (xhr, url) => {xhr.setRequestHeader(\"Content-Language\", \"test\");}\n          // not working, as xhr.setRequestHeader expects xhr.readyState === OPEN\n          xhr.open('GET', context.url, true);\n          xhrSetup(xhr, context.url);\n        }\n      }\n      if (!xhr.readyState) {\n        xhr.open('GET', context.url, true);\n      }\n    } catch (e) {\n      // IE11 throws an exception on xhr.open if attempting to access an HTTP resource over HTTPS\n      this.callbacks.onError({ code: xhr.status, text: e.message }, context, xhr);\n      return;\n    }\n\n    if (context.rangeEnd) {\n      xhr.setRequestHeader('Range', 'bytes=' + context.rangeStart + '-' + (context.rangeEnd - 1));\n    }\n\n    xhr.onreadystatechange = this.readystatechange.bind(this);\n    xhr.onprogress = this.loadprogress.bind(this);\n    xhr.responseType = context.responseType;\n\n    // setup timeout before we perform request\n    this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), this.config.timeout);\n    xhr.send();\n  }\n\n  readystatechange (event) {\n    let xhr = event.currentTarget,\n      readyState = xhr.readyState,\n      stats = this.stats,\n      context = this.context,\n      config = this.config;\n\n    // don't proceed if xhr has been aborted\n    if (stats.aborted) {\n      return;\n    }\n\n    // >= HEADERS_RECEIVED\n    if (readyState >= 2) {\n      // clear xhr timeout and rearm it if readyState less than 4\n      window.clearTimeout(this.requestTimeout);\n      if (stats.tfirst === 0) {\n        stats.tfirst = Math.max(performance.now(), stats.trequest);\n      }\n\n      if (readyState === 4) {\n        let status = xhr.status;\n        // http status between 200 to 299 are all successful\n        if (status >= 200 && status < 300) {\n          stats.tload = Math.max(stats.tfirst, performance.now());\n          let data, len;\n          if (context.responseType === 'arraybuffer') {\n            data = xhr.response;\n            len = data.byteLength;\n          } else {\n            data = xhr.responseText;\n            len = data.length;\n          }\n          stats.loaded = stats.total = len;\n          let response = { url: xhr.responseURL, data: data };\n          this.callbacks.onSuccess(response, stats, context, xhr);\n        } else {\n          // if max nb of retries reached or if http status between 400 and 499 (such error cannot be recovered, retrying is useless), return error\n          if (stats.retry >= config.maxRetry || (status >= 400 && status < 499)) {\n            this.callbacks.onError({ code: status, text: xhr.statusText }, context, xhr);\n          } else {\n            // aborts and resets internal state\n            this.destroy();\n            // schedule retry\n            this.retryTimeout = window.setTimeout(this.loadInternal.bind(this), this.retryDelay);\n            // set exponential backoff\n            this.retryDelay = Math.min(2 * this.retryDelay, config.maxRetryDelay);\n            stats.retry++;\n          }\n        }\n      } else {\n        // readyState >= 2 AND readyState !==4 (readyState = HEADERS_RECEIVED || LOADING) rearm timeout as xhr not finished yet\n        this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), config.timeout);\n      }\n    }\n  }\n\n  loadtimeout () {\n    this.callbacks.onTimeout(this.stats, this.context, null);\n  }\n\n  loadprogress (event) {\n    let xhr = event.currentTarget,\n      stats = this.stats;\n\n    stats.loaded = event.loaded;\n    if (event.lengthComputable) {\n      stats.total = event.total;\n    }\n\n    let onProgress = this.callbacks.onProgress;\n    if (onProgress) {\n      // third arg is to provide on progress data\n      onProgress(stats, this.context, null, xhr);\n    }\n  }\n}\n\nexport default XhrLoader;\n","import {PlaylistModel} from \"../Models/Playlist\";\nimport {nowInFormatYmdHis} from \"../utils/date\";\nimport XhrLoader from \"../utils/xhr-loader\";\n\nconst Hls = window.Hls;\n\nconst faceMimePromise = () => {\n  return new Promise((resolve) => {\n    resolve({});\n  })\n};\n\nclass RealtimeRecordController {\n  constructor(plugin) {\n    this.plugin = plugin;\n    this.manifestListener = null;\n    this.levelListener = null;\n    this.fragmentListener = null;\n    this.recordStarted = false;\n\n    this.playlist = null;\n  }\n\n  init() {\n    const hlsjs = this.plugin.getHlsJs();\n    this.fragmentListener = hlsjs.on(Hls.Events.FRAG_LOADED, this.hlsFragmentLoaded);\n  }\n\n  startRecord() {\n    this.playlist = null;\n    this.recordStarted = true;\n  }\n\n  stopRecord() {\n    this.recordStarted = false;\n    if(this.playlist) {\n      this.playlist.finished();\n      this.plugin.storageController.savePlaylist(this.playlist);\n    }\n  }\n\n  saveFragment(frag) {\n    if(this.playlist === null) {\n      this.initPlaylist(frag.level);\n    }\n\n    if(this.playlist === null) {\n      return;\n    }\n\n    const loader = new XhrLoader();\n    const url = frag.url;\n    const loaderContext = {\n      url,\n      frag: this.playlist.addFragment(frag.duration, url),\n      responseType: 'arraybuffer',\n      progressData: false,\n      loader\n    };\n    const loaderConfig = {\n      timeout: 60,\n      maxRetry: 0,\n      retryDelay: 0,\n      maxRetryDelay: 3\n    };\n\n    const loaderCallbacks = {\n      onSuccess: this.fragmentLoaded,\n    };\n    loader.load(loaderContext, loaderConfig, loaderCallbacks);\n  }\n\n  initPlaylist(levelIndex) {\n    const hlsjs = this.plugin.getHlsJs();\n    const level = hlsjs.levels[levelIndex];\n    const mimePromise = (this.plugin.options.realtimeRecord.getRecordMime || faceMimePromise)();\n\n    if(!level) {\n      return;\n    }\n\n    this.playlist = new PlaylistModel({\n      id: 'record-' + nowInFormatYmdHis(),\n      width: level.width,\n      height: level.height,\n      targetduration: level.details.targetduration\n    });\n\n    mimePromise.then((mime) => {\n      this.playlist.mime = mime;\n      this.plugin.storageController.savePlaylist(this.playlist);\n    })\n  }\n\n  fragmentLoaded = (response, stats, context, networkDetails = null) => {\n    context.loader.destroy();\n    context.loader = null;\n\n    this.plugin.storageController.saveFragment(context.frag, response.data, stats).then(() => {\n      this.playlist.fragmentSaved(context.frag);\n      this.plugin.storageController.savePlaylist(this.playlist);\n    });\n  };\n\n  hlsFragmentLoaded = (event, data) => {\n    if(this.recordStarted) {\n      this.saveFragment(data.frag);\n    }\n  };\n}\n\nexport default RealtimeRecordController;\n","import './plugin.scss';\nimport videojs from 'video.js';\nconst Plugin = videojs.getPlugin('plugin');\nimport {version as VERSION} from '../package.json';\nimport ProgressControlHlsJs from \"./components/ProgressControlHlsJs\";\nimport LiveButtonHlsJs from \"./components/LiveButtonHlsJs\";\nimport CachedButtonHlsJs from \"./components/CachedButtonHlsJs\";\nimport RecButtonHlsJs from \"./components/RecButtonHlsJs\";\nimport StopButtonHlsJs from \"./components/StopButtonHlsJs\";\nimport RecStatusBarHlsJs from \"./components/RecStatusBarHlsJs\";\nimport ViewController from \"./Controllers/ViewController\";\nimport StorageController from \"./Controllers/StorageController\";\nimport RealtimeRecordController from \"./Controllers/RealtimeRecordController\";\n\n\n/**\n * A Default configuration\n * @typedef {Object} DefaultConfig\n * @property {string[]} listOfControlsHiddenOnRec - List of interface elements that should be hidden in recording mode\n * @property {string} storageDbName - The name of the IndexedDB database used to save records\n * @property {string} storagePlaylistsName - The name of the playlists storage\n * @property {string} storageFragmentsName - The name of the fragments storage\n * @property {number} maxRecordMinutes - Maximum record duration in minutes\n * @property {boolean} allowed - Enable recording functionality\n * @property {null | callback<string | HTMLElement>} notAllowedContent - This content will be displayed if recording not allowed\n * @property {object} realtimeRecord - Realtime recording configuration\n * @property {boolean} realtimeRecord.allowed - Enable realtime recording functionality\n * @property {boolean} realtimeRecord.hideIfNotAllowed - Hide realtime recording tab if realtime recording not allowed\n * @property {null | callback<string | HTMLElement>} realtimeRecord.modalHeaderContent - Header content of the realtime recording tab\n * @property {null | callback<string | HTMLElement>} realtimeRecord.modalFooterContent - Footer content of the realtime recording tab\n * @property {null | callback<string | HTMLElement>} realtimeRecord.notAllowedContent - This content will be displayed if realtime recording not allowed\n * @property {null | callback<Promise<object>>} realtimeRecord.getRecordMime - Object returned by this function will be included in playlist and can be used later\n */\n\n/**\n *\n * @type {DefaultConfig}\n */\nconst defaults = {\n  listOfControlsHiddenOnRec: ['vjs-play-control', 'vjs-quality-selector'],\n  storageDbName: 'vjs-hlsjs-lr',\n  storagePlaylistsName: 'playlists',\n  storageFragmentsName: 'fragments',\n  maxRecordMinutes: 60,\n  allowed: true,\n  notAllowedContent: null,\n  realtimeRecord: {\n    allowed: true,\n    modalHeaderContent: null,\n    modalFooterContent: null,\n    notAllowedContent: null,\n    getRecordMime: null,\n  }\n};\n\nclass HlsJSLiveRecordPlugin extends Plugin {\n\n  constructor(player, options) {\n    super(player, options);\n    this.options = videojs.mergeOptions(defaults, options);\n    this.storageController = new StorageController(this);\n    this.viewController = new ViewController(this);\n    this.realtimeRecordController = new RealtimeRecordController(this);\n\n    player.on('playing', () => {\n      this.init();\n    });\n  }\n\n  init = () => {\n    if(this.state.init) {\n      return;\n    }\n\n    this.setState({init: true});\n    if(this.checkRequirements()) {\n      this.player.addClass('vjs-hls-live-record');\n      this.player.on('pause', this.viewController.activateProgressMode);\n      this.viewController.init();\n      this.storageController.init();\n      this.realtimeRecordController.init();\n    } else {\n      videojs.log.warn('HlsJSLiveRecordPlugin: cannot be initialized because one or more of the requirements are not met.');\n    }\n  };\n\n  checkRequirements = () => {\n    if(!this.getHlsJs()) {\n      videojs.log.warn('HlsJSLiveRecordPlugin: HLS.JS plugin not found.');\n      return false;\n    }\n\n    if(!this.storageController.checkRequirements()) {\n      videojs.log.warn('HlsJSLiveRecordPlugin: This browser doesn\\'t support IndexedDB.');\n      return false;\n    }\n    return true;\n  };\n\n  getHlsJs = () => {\n    return this.player.tech({ IWillUseThisInPlugin: true }).sourceHandler_.hls;\n  };\n\n  startRealtimeRecord(levelId) {\n\n    this.setState({\n      recordInProcess: true\n    });\n\n    this.getHlsJs().currentLevel = levelId * 1;\n    this.viewController.activateRecordMode();\n\n    this.realtimeRecordController.startRecord();\n  }\n\n  stopRealtimeRecord = () => {\n    this.realtimeRecordController.stopRecord();\n    this.viewController.activeLiveMode();\n    this.setState({\n      recordInProcess: false\n    });\n    this.getHlsJs().currentLevel = -1;\n  };\n\n  handleStateChanged(e) {\n\n  }\n}\n\nHlsJSLiveRecordPlugin.VERSION = VERSION;\n\nHlsJSLiveRecordPlugin.defaultState = {\n  recordAllowed: true,\n  recordInProcess: false,\n  init: false\n};\n\nvideojs.registerPlugin('hlsJSLiveRecord', HlsJSLiveRecordPlugin);\nvideojs.registerComponent('ProgressControlHlsJs', ProgressControlHlsJs);\nvideojs.registerComponent('LiveButtonHlsJs', LiveButtonHlsJs);\nvideojs.registerComponent('CachedButtonHlsJs', CachedButtonHlsJs);\nvideojs.registerComponent('RecButtonHlsJs', RecButtonHlsJs);\nvideojs.registerComponent('StopButtonHlsJs', StopButtonHlsJs);\nvideojs.registerComponent('RecStatusBarHlsJs', RecStatusBarHlsJs);\n"],"sourceRoot":""}